<!DOCTYPE html>
<html>
<head>
  <title>UV Traders - Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<h2>UV Traders â€“ Recommendations</h2>
<div id="list">Loading...</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, getDocs, query, orderBy } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
  import { getAuth, onAuthStateChanged } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDp81qEmGP9du2i-ZTEUppYPDZ97juFFrU",
    authDomain: "uv-traders.firebaseapp.com",
    projectId: "uv-traders",
    storageBucket: "uv-traders.appspot.com",
    messagingSenderId: "771893007700",
    appId: "1:771893007700:web:1aae9ccea416989c44e4c1"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);

  const list = document.getElementById("list");

  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      window.location.href = "index.html";
      return;
    }

    list.innerHTML = "";
    const q = query(
      collection(db, "recommendations"),
      orderBy("createdAt", "desc")
    );

    const snap = await getDocs(q);

    if (snap.empty) {
      list.innerHTML = "No recommendations yet.";
      return;
    }

    snap.forEach(doc => {
      const d = doc.data();
      list.innerHTML += `
        <hr>
        <b>${d.stock}</b><br>
        Buy: ${d.buy}<br>
        SL: ${d.sl}<br>
        Target: ${d.target}<br>
        Status: ${d.status}<br>
        Profit: ${d.profit || "-"}%
      `;
    });
  });
</script>

</body>
</html>
